<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8">
  <title>Gestion des commandes</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

</head>

<body>
<div th:replace="~{fragments/header :: header}"></div>

<div class="container my-2">
  <h1 style="margin-bottom: 10px">Liste des produits de la commande</h1>
  <hr>

  <div class="row" th:object="${order}">
    <h3>Description:</h3>
    <span th:text="${order.description}"></span>

    <h3>Client:</h3>
    <span th:text="${order.customer.firstname} + ' ' + ${order.customer.name}"></span>

    <h3>Statut:</h3>
    <span th:text="${order.status}"></span>

    <h3>Reservation?</h3>
    <span th:text="${order.reservation}"></span>
  </div>

  <br><br>

  <div class="row">
    <form
            method="post"
            role="form"
            th:action="@{/user/add-order-product}"
            th:object="${orderProduct}"
    >
<!--      <div th:if="${param.success}">-->
<!--        <div class="alert alert-info">-->
<!--          Ajout reussi !!!-->
<!--        </div>-->
<!--      </div>-->
      <div class="mb-3">
        <label for="products">Selectionner un produit</label>
        <select class="form-control selectpicker" th:field="*{product}" id="products">
          <option th:each="product : ${productList}"
                  th:value="${product.id}"
                  th:text="${product.name}">
          </option>
        </select>
      </div>
      <div class="mb-3">
        <label class="form-label" for="quantity">Quantité</label>
        <input class="form-control" id="quantity" name="quantity" type="text">
        <p class="text-danger" th:errors="*{quantity}"
           th:if="${#fields.hasErrors('quantity')}"></p>
      </div>

      <input type="hidden" th:field="*{order}" class="form-control mb-4 col-8">

      <div class="mb-3">
        <button class="btn btn-primary mb-3" type="submit">Ajouter</button>
      </div>
    </form>
  </div>

  <table border="1" class="table table-striped table-responsive-md">
    <thead>
    <tr>
      <th>Reférence</th>
      <th>Nom</th>
      <th>Description</th>
      <th>Prix</th>
      <th>Quantité</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="orderProduct : ${listOrderProduct}">
      <td th:text="${orderProduct.product.reference}"></td>
      <td th:text="${orderProduct.product.name}"></td>
      <td th:text="${orderProduct.product.description}"></td>
      <td th:text="${orderProduct.product.price}"></td>
      <td th:text="${orderProduct.quantity}"></td>
      <td>
        <a th:href="@{/user/delete-product-order-by-key/{orderId}/{productId}(orderId=${orderProduct.order.id}, productId=${orderProduct.product.id})}"
           class="btn btn-danger">Supprimer</a>
      </td>
    </tr>
    </tbody>
  </table>
</div>
</body>

</html>